<!DOCTYPE HTML>
<html>
<head>
    <!-- <meta charset="utf-8"> -->
    <title>Canvas Background through CSS</title>
   
   <style type="text/css" media="screen">
      canvas, img { display:block; width: 1200px; height: 600px; margin:4em auto; border:2px solid black; }
      canvas { background:url(musicstaff.png) }

    /* <style>
        body {
            margin: 0;
            overflow: none;
        } */
        h1 {
            margin-top: 0.25em;
            font-size: 70px;
        }
    </style>
    
</head>
    <h1> ATC Music Game </h1>
<body>

    </div>
    <canvas id="canvas" ></canvas>
    <div style="display:none;">
        <img id="source" src="musicnote.png" width="3" height="3">
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const image = document.getElementById('source');
        // document.body.style.background = "url('musicstaff.png')";
        
  
        const coords = [];
 
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
 
        var x = 0, y = 0;
       
        ctx.globalAlpha = 0.5;
        ctx.fillStyle = "#474973";
        //ctx.fillRect(0, 0, canvas.width, 50);
 
        // Stores picture color data (not including GUIs)
        // const imageData = ctx.createImageData(canvas.width, canvas.height);
 
        loop();
        // initialize the canvas
 
        // update the rectangle
       
        function update_rectangle_leftright() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillRect(x - 50, 0, 100, canvas.height);
            // ctx.fillRect(0, y - 10, canvas.width, 20);
            drawLines();
            ++x;
            x %= canvas.width;
        }
 
        function update_rectangle_updown() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillRect(0, y - 80, canvas.width, 160);
            ctx.fillRect(x - 50, 0, 100, canvas.height);
            drawLines();
            ++y;
            y %= canvas.height;
        }
       
        // on click --> stop the rectangle from ov ing and print the x and y coordinate
 
        function drawLines() {
            ctx.globalAlpha = 1;
            for(let i = 0; i<coords.length; i++){
                //ctx.clearRect(0, 0, canvas.width, canvas.height);
                // ctx.beginPath();
                // ctx.arc(coords[i].x,coords[i].y,6,0,Math.PI*2   );code for dot instead of music note
                // ctx.fill();
                // ctx.closePath();
 
                ctx.drawImage(image, coords[i].x - 75, coords[i].y - 75, 150, 150);
            }
           
 
            //ctx.fillStyle = "#474973";
            ctx.globalAlpha = 0.5; //transparency of the lines
        }
 
        function loop(){
            x = 210;
            y = 50;
            // on click stop the loop
            let continueloop = true;
            document.addEventListener('keydown', function _listener(e) {
                if (e.key !== ' ')
                    return;
                e.preventDefault();  
                continueloop = false;
                document.removeEventListener('keydown', _listener, true);
            });
 
            function updateUpDownTimeout() {
                update_rectangle_updown();
                if (continueloop) {
                    setTimeout(updateUpDownTimeout, 50);
                } else {
                    // We have x and y; end loop
                   
                    coords.push({x: x, y: y});
                    loop();
                }
            }
 
            function updateLeftRightTimeout() {
                update_rectangle_leftright();
                if (continueloop) {
                    setTimeout(updateLeftRightTimeout, 50);
                } else {
                    continueloop = true;
                    setTimeout(updateUpDownTimeout, 50);
                    document.addEventListener('keydown', function _listener(e) {
                        if (e.key !== ' ')
                            return;
                        continueloop = false;
                        e.preventDefault();
                        //document.getElementById('x_y').innerHTML = x+" "+y;
                       
                        document.removeEventListener('keydown', _listener, true);
                    })
                }
            }
       
            setTimeout(updateLeftRightTimeout, 50);
            // timer
            // call update
            
        }
 
    </script>
</body>
</html>
